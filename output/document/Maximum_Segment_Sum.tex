%
\begin{isabellebody}%
\setisabellecontext{Maximum{\isacharunderscore}{\kern0pt}Segment{\isacharunderscore}{\kern0pt}Sum}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Maximum Segment Sum%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Maximum{\isacharunderscore}{\kern0pt}Segment{\isacharunderscore}{\kern0pt}Sum\isanewline
\ \ \isakeyword{imports}\ Main\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
The \emph{maximum segment sum} problem is to compute, given a list of numbers,
the largest of the sums of the contiguous segments of that list. It is also known
as the \emph{maximum sum subarray} problem and has been considered many times in the literature;
the Wikipedia article ``Maximum subarray problem''
\url{https://en.wikipedia.org/wiki/Maximum_subarray_problem} is a good starting point.

We assume that the elements of the list are not necessarily numbers but just elements
of some linearly ordered additive Abelian group.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{context}\isamarkupfalse%
\ linordered{\isacharunderscore}{\kern0pt}ab{\isacharunderscore}{\kern0pt}group{\isacharunderscore}{\kern0pt}add\isanewline
\isakeyword{begin}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Naive Solution%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{fun}\isamarkupfalse%
\ mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}aux\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ list\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}aux\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}aux\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ max\ {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}x\ {\isacharplus}{\kern0pt}\ mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}aux\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ list\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ max\ {\isacharparenleft}{\kern0pt}mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}aux\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ fronts\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ list\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ list\ set{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}fronts\ xs\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}as{\isachardot}{\kern0pt}\ {\isasymexists}bs{\isachardot}{\kern0pt}\ xs\ {\isacharequal}{\kern0pt}\ as\ {\isacharat}{\kern0pt}\ bs{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}front{\isacharunderscore}{\kern0pt}sums\ xs\ {\isasymequiv}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharbackquote}{\kern0pt}\ fronts\ xs{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fronts{\isacharunderscore}{\kern0pt}cons{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fronts\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharhash}{\kern0pt}{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ fronts\ xs\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}l\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}r{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}l\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}r{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ as\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}as\ {\isasymin}\ {\isacharquery}{\kern0pt}l{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}as\ {\isasymin}\ {\isacharquery}{\kern0pt}r{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ fronts{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}r\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}l{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ fronts{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}cons{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}front{\isacharunderscore}{\kern0pt}sums\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ x\ {\isacharbackquote}{\kern0pt}\ front{\isacharunderscore}{\kern0pt}sums\ xs\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sum{\isacharunderscore}{\kern0pt}list\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharhash}{\kern0pt}{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ fronts\ xs\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ x\ {\isacharbackquote}{\kern0pt}\ front{\isacharunderscore}{\kern0pt}sums\ xs{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ fronts{\isacharunderscore}{\kern0pt}cons{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}fronts{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}fronts\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ xs{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fronts{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ fronts{\isacharunderscore}{\kern0pt}cons{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ finite{\isacharunderscore}{\kern0pt}fronts\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}front{\isacharunderscore}{\kern0pt}sums\ xs\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ fronts{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ image{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ max{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sum{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Max\ {\isacharparenleft}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ max\ {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}x\ {\isacharplus}{\kern0pt}\ Max\ {\isacharparenleft}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty\isanewline
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}cons\ hom{\isacharunderscore}{\kern0pt}Max{\isacharunderscore}{\kern0pt}commute\ max{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}aux\ xs\ {\isacharequal}{\kern0pt}\ Max\ {\isacharparenleft}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ xs{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ fronts{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ auto\ simp{\isacharcolon}{\kern0pt}\ max{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sum{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}front{\isacharunderscore}{\kern0pt}sums\ xs\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}s{\isachardot}{\kern0pt}\ {\isasymexists}as\ bs{\isachardot}{\kern0pt}\ xs\ {\isacharequal}{\kern0pt}\ as\ {\isacharat}{\kern0pt}\ bs\ {\isasymand}\ s\ {\isacharequal}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ as{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ fronts{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}aux\ xs\ {\isacharequal}{\kern0pt}\ Max\ {\isacharbraceleft}{\kern0pt}s{\isachardot}{\kern0pt}\ {\isasymexists}as\ bs{\isachardot}{\kern0pt}\ xs\ {\isacharequal}{\kern0pt}\ as\ {\isacharat}{\kern0pt}\ bs\ {\isasymand}\ s\ {\isacharequal}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ as{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums\ mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ mids\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ list\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ list\ set{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}mids\ xs\ {\isasymequiv}\ {\isacharbraceleft}{\kern0pt}bs{\isachardot}{\kern0pt}\ {\isasymexists}as\ cs{\isachardot}{\kern0pt}\ xs\ {\isacharequal}{\kern0pt}\ as\ {\isacharat}{\kern0pt}\ bs\ {\isacharat}{\kern0pt}\ cs{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}mid{\isacharunderscore}{\kern0pt}sums\ xs\ {\isasymequiv}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharbackquote}{\kern0pt}\ mids\ xs{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fronts{\isacharunderscore}{\kern0pt}mids{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bs\ {\isasymin}\ fronts\ xs\ {\isasymLongrightarrow}\ bs\ {\isasymin}\ mids\ xs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ fronts{\isacharunderscore}{\kern0pt}def\ mids{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mids{\isacharunderscore}{\kern0pt}mids{\isacharunderscore}{\kern0pt}cons{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bs\ {\isasymin}\ mids\ xs\ {\isasymLongrightarrow}\ bs\ {\isasymin}\ mids\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ bs\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}bs\ {\isasymin}\ mids\ xs{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ as\ cs\ \isakeyword{where}\ {\isachardoublequoteopen}xs\ {\isacharequal}{\kern0pt}\ as\ {\isacharat}{\kern0pt}\ bs\ {\isacharat}{\kern0pt}\ cs{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ mids{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharhash}{\kern0pt}\ xs\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}as{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ bs\ {\isacharat}{\kern0pt}\ cs{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}bs\ {\isasymin}\ mids\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ mids{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mids{\isacharunderscore}{\kern0pt}cons{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mids\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fronts\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isasymunion}\ mids\ xs{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}l\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}r{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}l\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}r{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ bs\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}bs\ {\isasymin}\ {\isacharquery}{\kern0pt}l{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ as\ cs\ \isakeyword{where}\ as{\isacharunderscore}{\kern0pt}bs{\isacharunderscore}{\kern0pt}cs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ as\ {\isacharat}{\kern0pt}\ bs\ {\isacharat}{\kern0pt}\ cs{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ mids{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}bs\ {\isasymin}\ {\isacharquery}{\kern0pt}r{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ as{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bs\ {\isasymin}\ fronts\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fronts{\isacharunderscore}{\kern0pt}def\ as{\isacharunderscore}{\kern0pt}bs{\isacharunderscore}{\kern0pt}cs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ as{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}xs\ {\isacharequal}{\kern0pt}\ as{\isacharprime}{\kern0pt}\ {\isacharat}{\kern0pt}\ bs\ {\isacharat}{\kern0pt}\ cs{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ as{\isacharunderscore}{\kern0pt}bs{\isacharunderscore}{\kern0pt}cs\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ mids{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}r\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}l{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ fronts{\isacharunderscore}{\kern0pt}mids\ mids{\isacharunderscore}{\kern0pt}mids{\isacharunderscore}{\kern0pt}cons\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}cons{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mid{\isacharunderscore}{\kern0pt}sums\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ front{\isacharunderscore}{\kern0pt}sums\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isasymunion}\ mid{\isacharunderscore}{\kern0pt}sums\ xs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ mids{\isacharunderscore}{\kern0pt}cons\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}mids{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}mids\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ xs{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mids{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ mids{\isacharunderscore}{\kern0pt}cons\ finite{\isacharunderscore}{\kern0pt}fronts{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ finite{\isacharunderscore}{\kern0pt}mids{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mid{\isacharunderscore}{\kern0pt}sums\ xs\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ mids{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ max{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}cons{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Max\ {\isacharparenleft}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ max\ {\isacharparenleft}{\kern0pt}Max\ {\isacharparenleft}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Max\ {\isacharparenleft}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}cons\ Max{\isacharunderscore}{\kern0pt}Un\ finite{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ finite{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sum{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive\ xs\ {\isacharequal}{\kern0pt}\ Max\ {\isacharparenleft}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ xs{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ mids{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ auto\ simp{\isacharcolon}{\kern0pt}\ max{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}cons\ mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}aux\ front{\isacharunderscore}{\kern0pt}sums{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mid{\isacharunderscore}{\kern0pt}sums{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mid{\isacharunderscore}{\kern0pt}sums\ xs\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}s{\isachardot}{\kern0pt}\ {\isasymexists}as\ bs\ cs{\isachardot}{\kern0pt}\ xs\ {\isacharequal}{\kern0pt}\ as\ {\isacharat}{\kern0pt}\ bs\ {\isacharat}{\kern0pt}\ cs\ {\isasymand}\ s\ {\isacharequal}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ bs{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ mids{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive\ xs\ {\isacharequal}{\kern0pt}\ Max\ {\isacharbraceleft}{\kern0pt}s{\isachardot}{\kern0pt}\ {\isasymexists}as\ bs\ cs{\isachardot}{\kern0pt}\ xs\ {\isacharequal}{\kern0pt}\ as\ {\isacharat}{\kern0pt}\ bs\ {\isacharat}{\kern0pt}\ cs\ {\isasymand}\ s\ {\isacharequal}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ bs{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ mss{\isacharunderscore}{\kern0pt}rec{\isacharunderscore}{\kern0pt}naive{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sum\ mid{\isacharunderscore}{\kern0pt}sums\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Kadane's Algorithms%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{fun}\isamarkupfalse%
\ kadane\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ list\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}kadane\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ cur\ m\ {\isacharequal}{\kern0pt}\ m{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}kadane\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ cur\ m\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}let\ cur{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ max\ {\isacharparenleft}{\kern0pt}cur\ {\isacharplus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ x\ in\isanewline
\ \ \ \ \ \ kadane\ xs\ cur{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}max\ m\ cur{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}mss{\isacharunderscore}{\kern0pt}kadane\ xs\ {\isasymequiv}\ kadane\ xs\ {\isadigit{0}}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Max{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}geq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Max\ {\isacharparenleft}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isasymin}\ fronts\ xs{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ fronts{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymin}\ front{\isacharunderscore}{\kern0pt}sums\ xs{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ Max{\isacharunderscore}{\kern0pt}ge\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Max{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}geq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Max\ {\isacharparenleft}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymin}\ mid{\isacharunderscore}{\kern0pt}sums\ xs{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ mids{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ Max{\isacharunderscore}{\kern0pt}ge\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ kadane{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}m\ {\isasymge}\ cur\ {\isasymLongrightarrow}\ m\ {\isasymge}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ kadane\ xs\ cur\ m\ {\isacharequal}{\kern0pt}\ max\ m\ {\isacharparenleft}{\kern0pt}max\ {\isacharparenleft}{\kern0pt}cur\ {\isacharplus}{\kern0pt}\ Max\ {\isacharparenleft}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Max\ {\isacharparenleft}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ xs\ cur\ m\ rule{\isacharcolon}{\kern0pt}\ kadane{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ cur\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{unfolding}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ fronts{\isacharunderscore}{\kern0pt}def\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ mids{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ x\ xs\ cur\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ max{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sum\ max{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}cons\ Let{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}threshold{\isacharparenright}{\kern0pt}\ Max{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}geq{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ add{\isacharunderscore}{\kern0pt}assoc\ add{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}right\ max{\isachardot}{\kern0pt}assoc\ max{\isachardot}{\kern0pt}coboundedI{\isadigit{1}}\ max{\isachardot}{\kern0pt}left{\isacharunderscore}{\kern0pt}commute\ max{\isachardot}{\kern0pt}orderE\ max{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ max{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Max{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}Max{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Max\ {\isacharparenleft}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}\ {\isasymle}\ Max\ {\isacharparenleft}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}front{\isacharunderscore}{\kern0pt}sums\ xs\ {\isasymsubseteq}\ mid{\isacharunderscore}{\kern0pt}sums\ xs{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ fronts{\isacharunderscore}{\kern0pt}mids\ subset{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty\ finite{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ Max{\isacharunderscore}{\kern0pt}mono\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mss{\isacharunderscore}{\kern0pt}kadane{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mss{\isacharunderscore}{\kern0pt}kadane\ xs\ {\isacharequal}{\kern0pt}\ Max\ {\isacharparenleft}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ mss{\isacharunderscore}{\kern0pt}kadane{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ kadane\ Max{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}geq{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ Max{\isacharunderscore}{\kern0pt}front{\isacharunderscore}{\kern0pt}sums{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}Max{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ mss{\isacharunderscore}{\kern0pt}kadane{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mss{\isacharunderscore}{\kern0pt}kadane\ xs\ {\isacharequal}{\kern0pt}\ Max\ {\isacharbraceleft}{\kern0pt}s{\isachardot}{\kern0pt}\ {\isasymexists}as\ bs\ cs{\isachardot}{\kern0pt}\ xs\ {\isacharequal}{\kern0pt}\ as\ {\isacharat}{\kern0pt}\ bs\ {\isacharat}{\kern0pt}\ cs\ {\isasymand}\ s\ {\isacharequal}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ bs{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ mss{\isacharunderscore}{\kern0pt}kadane{\isacharunderscore}{\kern0pt}mid{\isacharunderscore}{\kern0pt}sums\ mid{\isacharunderscore}{\kern0pt}sums\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Maximum_Segment_Sum.tex%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%39=7%:%
%:%40=8%:%
%:%41=9%:%
%:%42=10%:%
%:%43=11%:%
%:%44=12%:%
%:%45=13%:%
%:%46=14%:%
%:%48=16%:%
%:%49=16%:%
%:%50=17%:%
%:%57=19%:%
%:%67=21%:%
%:%68=21%:%
%:%69=22%:%
%:%70=23%:%
%:%71=24%:%
%:%72=25%:%
%:%73=25%:%
%:%74=26%:%
%:%75=27%:%
%:%76=28%:%
%:%77=29%:%
%:%78=29%:%
%:%79=30%:%
%:%80=31%:%
%:%81=32%:%
%:%82=32%:%
%:%83=33%:%
%:%84=34%:%
%:%85=34%:%
%:%92=35%:%
%:%93=35%:%
%:%94=36%:%
%:%95=36%:%
%:%96=37%:%
%:%97=37%:%
%:%98=38%:%
%:%99=38%:%
%:%100=38%:%
%:%101=39%:%
%:%102=39%:%
%:%103=39%:%
%:%104=39%:%
%:%105=40%:%
%:%106=40%:%
%:%107=41%:%
%:%108=41%:%
%:%109=41%:%
%:%110=41%:%
%:%111=42%:%
%:%117=42%:%
%:%120=43%:%
%:%121=44%:%
%:%122=44%:%
%:%129=45%:%
%:%130=45%:%
%:%131=46%:%
%:%132=46%:%
%:%133=46%:%
%:%134=46%:%
%:%135=47%:%
%:%136=47%:%
%:%137=47%:%
%:%138=47%:%
%:%139=48%:%
%:%145=48%:%
%:%148=49%:%
%:%149=50%:%
%:%150=50%:%
%:%153=51%:%
%:%157=51%:%
%:%158=51%:%
%:%163=51%:%
%:%166=52%:%
%:%167=53%:%
%:%168=53%:%
%:%171=54%:%
%:%175=54%:%
%:%176=54%:%
%:%177=54%:%
%:%182=54%:%
%:%185=55%:%
%:%186=56%:%
%:%187=56%:%
%:%190=57%:%
%:%194=57%:%
%:%195=57%:%
%:%196=57%:%
%:%197=57%:%
%:%202=57%:%
%:%205=58%:%
%:%206=59%:%
%:%207=59%:%
%:%214=60%:%
%:%215=60%:%
%:%216=61%:%
%:%217=61%:%
%:%222=61%:%
%:%225=62%:%
%:%226=63%:%
%:%227=63%:%
%:%234=64%:%
%:%235=64%:%
%:%240=64%:%
%:%243=65%:%
%:%244=66%:%
%:%245=66%:%
%:%252=67%:%
%:%253=67%:%
%:%254=67%:%
%:%259=67%:%
%:%262=68%:%
%:%263=69%:%
%:%264=69%:%
%:%271=70%:%
%:%272=70%:%
%:%273=70%:%
%:%278=70%:%
%:%281=71%:%
%:%282=72%:%
%:%283=73%:%
%:%284=73%:%
%:%285=74%:%
%:%286=75%:%
%:%287=76%:%
%:%288=76%:%
%:%289=77%:%
%:%290=78%:%
%:%291=78%:%
%:%298=79%:%
%:%299=79%:%
%:%300=79%:%
%:%305=79%:%
%:%308=80%:%
%:%309=81%:%
%:%310=81%:%
%:%317=82%:%
%:%318=82%:%
%:%319=83%:%
%:%320=83%:%
%:%321=83%:%
%:%322=84%:%
%:%323=84%:%
%:%324=84%:%
%:%325=84%:%
%:%326=84%:%
%:%327=85%:%
%:%328=85%:%
%:%329=85%:%
%:%330=85%:%
%:%331=86%:%
%:%332=86%:%
%:%333=86%:%
%:%334=86%:%
%:%335=86%:%
%:%336=87%:%
%:%342=87%:%
%:%345=88%:%
%:%346=89%:%
%:%347=89%:%
%:%354=90%:%
%:%355=90%:%
%:%356=91%:%
%:%357=91%:%
%:%358=92%:%
%:%359=92%:%
%:%360=93%:%
%:%361=93%:%
%:%362=93%:%
%:%363=94%:%
%:%364=94%:%
%:%365=94%:%
%:%366=94%:%
%:%367=94%:%
%:%368=95%:%
%:%369=95%:%
%:%370=95%:%
%:%371=96%:%
%:%372=96%:%
%:%373=97%:%
%:%374=97%:%
%:%375=98%:%
%:%376=98%:%
%:%377=98%:%
%:%378=98%:%
%:%379=99%:%
%:%380=99%:%
%:%381=99%:%
%:%382=99%:%
%:%383=100%:%
%:%384=100%:%
%:%385=101%:%
%:%386=101%:%
%:%387=102%:%
%:%388=102%:%
%:%389=102%:%
%:%390=102%:%
%:%391=102%:%
%:%392=103%:%
%:%393=103%:%
%:%394=103%:%
%:%395=103%:%
%:%396=103%:%
%:%397=104%:%
%:%398=104%:%
%:%399=105%:%
%:%400=105%:%
%:%401=106%:%
%:%402=106%:%
%:%403=106%:%
%:%404=106%:%
%:%405=107%:%
%:%411=107%:%
%:%414=108%:%
%:%415=109%:%
%:%416=109%:%
%:%419=110%:%
%:%423=110%:%
%:%424=110%:%
%:%425=110%:%
%:%430=110%:%
%:%433=111%:%
%:%434=112%:%
%:%435=112%:%
%:%438=113%:%
%:%442=113%:%
%:%443=113%:%
%:%448=113%:%
%:%451=114%:%
%:%452=115%:%
%:%453=115%:%
%:%456=116%:%
%:%460=116%:%
%:%461=116%:%
%:%466=116%:%
%:%469=117%:%
%:%470=118%:%
%:%471=118%:%
%:%474=119%:%
%:%478=119%:%
%:%479=119%:%
%:%480=119%:%
%:%485=119%:%
%:%488=120%:%
%:%489=121%:%
%:%490=121%:%
%:%493=122%:%
%:%497=122%:%
%:%498=122%:%
%:%503=122%:%
%:%506=123%:%
%:%507=124%:%
%:%508=124%:%
%:%511=125%:%
%:%515=125%:%
%:%516=125%:%
%:%521=125%:%
%:%524=126%:%
%:%525=127%:%
%:%526=127%:%
%:%529=128%:%
%:%533=128%:%
%:%534=128%:%
%:%539=128%:%
%:%542=129%:%
%:%543=130%:%
%:%544=130%:%
%:%547=131%:%
%:%551=131%:%
%:%552=131%:%
%:%553=131%:%
%:%567=134%:%
%:%577=136%:%
%:%578=136%:%
%:%579=137%:%
%:%580=138%:%
%:%582=140%:%
%:%583=141%:%
%:%584=142%:%
%:%585=142%:%
%:%586=143%:%
%:%587=144%:%
%:%588=144%:%
%:%595=145%:%
%:%596=145%:%
%:%597=146%:%
%:%598=146%:%
%:%599=146%:%
%:%600=146%:%
%:%601=147%:%
%:%602=147%:%
%:%603=147%:%
%:%604=147%:%
%:%605=147%:%
%:%606=148%:%
%:%607=148%:%
%:%608=148%:%
%:%609=148%:%
%:%610=148%:%
%:%611=149%:%
%:%617=149%:%
%:%620=150%:%
%:%621=151%:%
%:%622=151%:%
%:%629=152%:%
%:%630=152%:%
%:%631=153%:%
%:%632=153%:%
%:%633=153%:%
%:%634=153%:%
%:%635=154%:%
%:%636=154%:%
%:%637=154%:%
%:%638=154%:%
%:%639=154%:%
%:%640=155%:%
%:%646=155%:%
%:%649=156%:%
%:%650=157%:%
%:%651=157%:%
%:%658=158%:%
%:%659=158%:%
%:%660=159%:%
%:%661=159%:%
%:%662=160%:%
%:%663=160%:%
%:%664=160%:%
%:%665=160%:%
%:%666=160%:%
%:%667=161%:%
%:%668=161%:%
%:%669=162%:%
%:%670=162%:%
%:%671=163%:%
%:%672=163%:%
%:%673=163%:%
%:%674=164%:%
%:%675=164%:%
%:%676=165%:%
%:%677=165%:%
%:%678=166%:%
%:%684=166%:%
%:%687=167%:%
%:%688=168%:%
%:%689=168%:%
%:%696=169%:%
%:%697=169%:%
%:%698=170%:%
%:%699=170%:%
%:%700=170%:%
%:%701=170%:%
%:%702=170%:%
%:%703=171%:%
%:%704=171%:%
%:%705=171%:%
%:%706=171%:%
%:%707=171%:%
%:%708=172%:%
%:%714=172%:%
%:%717=173%:%
%:%718=174%:%
%:%719=174%:%
%:%722=175%:%
%:%726=175%:%
%:%727=175%:%
%:%728=175%:%
%:%729=175%:%
%:%734=175%:%
%:%737=176%:%
%:%738=177%:%
%:%739=177%:%
%:%742=178%:%
%:%746=178%:%
%:%747=178%:%
%:%748=178%:%
%:%753=178%:%
%:%756=179%:%
%:%757=180%:%
%:%758=180%:%
%:%761=181%:%
%:%766=182%:%
